<script>
  // Verificar si el admin está logueado
  if(localStorage.getItem("adminLogged") !== "true"){
      // Si no está logueado, redirigir a admin.html
      window.location.href = "admin.html";
  }
</script>
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Admin - LATAM-STORE</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1 class="neon-text">Panel Admin</h1>
        <button onclick="logout()" class="logout-btn">Cerrar Sesión</button>
    </header>

    <main>
        <section>
            <h2>Añadir Producto</h2>
            <input type="text" id="prod-name" placeholder="Nombre del producto">
            <input type="number" id="prod-price" placeholder="Precio">
            <button onclick="addProduct()">Agregar Producto</button>
        </section>

        <section>
            <h2>Productos Agregados</h2>
            <div id="product-list"></div>
        </section>
    </main>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

    <script>
        // Configura tu Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyARKe_fiXphpqc_6QbbcGo4yMI9FoJClUw",
            authDomain: "latak-store.firebaseapp.com",
            databaseURL: "https://latak-store-default-rtdb.firebaseio.com",
            projectId: "latak-store",
            storageBucket: "latak-store.firebasestorage.app",
            messagingSenderId: "37124193954",
            appId: "1:37124193954:web:f0720f148e160b711fa1fb"
        };

        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.database();

        // Verifica si el admin está logueado
        if(localStorage.getItem("adminLogged") !== "true"){
            window.location.href = "admin.html";
        }

        // Cerrar sesión
        function logout(){
            localStorage.removeItem("adminLogged");
            window.location.href = "admin.html";
        }

        // Agregar producto
        function addProduct(){
            const name = document.getElementById("prod-name").value;
            const price = parseFloat(document.getElementById("prod-price").value);

            if(!name || !price){
                alert("Llena todos los campos");
                return;
            }

            const newProductRef = db.ref("products").push();
            newProductRef.set({
                name: name,
                price: price
            }).then(() => {
                alert("Producto agregado exitosamente");
                document.getElementById("prod-name").value = "";
                document.getElementById("prod-price").value = "";
            }).catch(error => {
                alert("Error al agregar producto: " + error);
            });
        }

        // Mostrar productos en tiempo real
        const productList = document.getElementById("product-list");
        const productsRef = db.ref("products");

        productsRef.on("value", snapshot => {
            productList.innerHTML = "";
            snapshot.forEach(childSnapshot => {
                const data = childSnapshot.val();
                const id = childSnapshot.key;
                const div = document.createElement("div");
                div.className = "product";
                div.innerHTML = `
                    <p>${data.name} - $${data.price}</p>
                    <button onclick="deleteProduct('${id}')">Eliminar</button>
                `;
                productList.appendChild(div);
            });
        });

        // Eliminar producto
        function deleteProduct(id){
            if(confirm("¿Seguro que quieres eliminar este producto?")){
                db.ref("products/" + id).remove()
                .then(() => alert("Producto eliminado"))
                .catch(error => alert("Error al eliminar: " + error));
            }
        }
    </script>
</body>
</html>
